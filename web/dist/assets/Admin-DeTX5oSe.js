var ae=Object.defineProperty,ue=Object.defineProperties;var re=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var ie=Object.prototype.hasOwnProperty,de=Object.prototype.propertyIsEnumerable;var Q=(B,u,r)=>u in B?ae(B,u,{enumerable:!0,configurable:!0,writable:!0,value:r}):B[u]=r,R=(B,u)=>{for(var r in u||(u={}))ie.call(u,r)&&Q(B,r,u[r]);if(J)for(var r of J(u))de.call(u,r)&&Q(B,r,u[r]);return B},W=(B,u)=>ue(B,re(u));var U=(B,u,r)=>new Promise((g,d)=>{var h=v=>{try{f(r.next(v))}catch($){d($)}},y=v=>{try{f(r.throw(v))}catch($){d($)}},f=v=>v.done?g(v.value):Promise.resolve(v.value).then(h,y);f((r=r.apply(B,u)).next())});import{_ as z,r as m,w as G,g as H,o as p,h as K,i as ce,c as w,d as A,n as L,b as e,t as T,T as ve,j as pe,l as j,m as b,v as V,q as N,F,a as P,k as q,u as O,s as Z,p as X,x as he,y as Y}from"./index-BSD0j5mj.js";import{g as ee,d as me,u as ge,e as we,f as fe,h as ke,i as be,j as ye,k as $e,l as _e,m as Me,n as Ce,c as Ve,a as Ue,o as Be,p as xe,q as Se,b as Ie,r as Te,s as Ae,t as Le,v as Fe,w as Pe,x as ze}from"./api-BuqCV8Ig.js";const He={class:"toast-icon"},Ne={key:0,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none"},je={key:1,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none"},De={key:2,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none"},Oe={key:3,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none"},Ke={class:"toast-message"},qe={__name:"Toast",props:{message:{type:String,default:""},type:{type:String,default:"info",validator:B=>["success","error","warning","info"].includes(B)},duration:{type:Number,default:3e3},show:{type:Boolean,default:!1}},emits:["update:show"],setup(B,{emit:u}){const r=B,g=u,d=m(!1);let h=null;return G(()=>r.show,y=>{y?(d.value=!0,h&&clearTimeout(h),h=setTimeout(()=>{d.value=!1,g("update:show",!1)},r.duration)):d.value=!1},{immediate:!0}),(y,f)=>(p(),H(pe,{to:"body"},[K(ve,{name:"toast"},{default:ce(()=>[d.value?(p(),w("div",{key:0,class:L(["toast-container",B.type])},[e("div",He,[B.type==="success"?(p(),w("svg",Ne,f[0]||(f[0]=[e("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"2"},null,-1),e("path",{d:"M8 12l2.5 2.5L16 9",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)]))):B.type==="error"?(p(),w("svg",je,f[1]||(f[1]=[e("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"2"},null,-1),e("path",{d:"M15 9l-6 6M9 9l6 6",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1)]))):B.type==="warning"?(p(),w("svg",De,f[2]||(f[2]=[e("path",{d:"M12 9v4M12 17h.01",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1),e("path",{d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z",stroke:"currentColor","stroke-width":"2"},null,-1)]))):(p(),w("svg",Oe,f[3]||(f[3]=[e("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"2"},null,-1),e("path",{d:"M12 16v-4M12 8h.01",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1)])))]),e("span",Ke,T(B.message),1)],2)):A("",!0)]),_:1})]))}},E=z(qe,[["__scopeId","data-v-8de2a713"]]),Ee={class:"menu-manage"},Ge={class:"menu-header"},Je={class:"menu-add"},Qe={class:"menu-content"},Re={class:"menu-list"},We={class:"main-menu"},Xe={class:"menu-info"},Ye=["onUpdate:modelValue","onBlur"],Ze={class:"menu-order"},et=["onUpdate:modelValue","onBlur"],tt={class:"menu-actions"},st=["onClick","title"],lt=["onClick"],nt={class:"sub-menu-header"},ot={class:"sub-menu-title"},at=["onClick"],ut={key:0,class:"sub-menu-list"},rt={class:"sub-menu-info"},it=["onUpdate:modelValue","onBlur"],dt={class:"sub-menu-order"},ct=["onUpdate:modelValue","onBlur"],vt={class:"sub-menu-actions"},pt=["onClick"],ht={key:1,class:"empty-sub-menu"},mt=["onClick"],gt={__name:"MenuManage",setup(B){const u=m([]),r=m(""),g=m({show:!1,message:"",type:"info"});function d(s,t="info"){g.value={show:!0,message:s,type:t}}j(h);function h(){return U(this,null,function*(){const s=yield ee();u.value=s.data.map(t=>W(R({},t),{showSubMenu:!1}))})}function y(){return U(this,null,function*(){var s,t;if(!r.value.trim()){d("请输入菜单名称","warning");return}try{const l=u.value.length?Math.max(...u.value.map(x=>x.order||0)):0;yield me({name:r.value.trim(),order:l+1}),r.value="",d("添加菜单成功","success"),h()}catch(l){d("添加菜单失败: "+(((t=(s=l.response)==null?void 0:s.data)==null?void 0:t.error)||l.message),"error")}})}function f(s){return U(this,null,function*(){var t,l;try{yield ge(s.id,{name:s.name,order:s.order}),h()}catch(x){d("更新菜单失败: "+(((l=(t=x.response)==null?void 0:t.data)==null?void 0:l.error)||x.message),"error")}})}function v(s){return U(this,null,function*(){var t,l;if(confirm("确定要删除这个主菜单吗？删除后将同时删除其下的所有子菜单和卡片。"))try{yield we(s),d("删除成功","success"),h()}catch(x){d("删除菜单失败: "+(((l=(t=x.response)==null?void 0:t.data)==null?void 0:l.error)||x.message),"error")}})}function $(s){return U(this,null,function*(){var x,_,C;const t=u.value.find(i=>i.id===s),l=prompt("请输入子菜单名称：");if(l!=null&&l.trim())try{const i=(x=t.subMenus)!=null&&x.length?Math.max(...t.subMenus.map(I=>I.order||0)):0;yield fe(s,{name:l.trim(),order:i+1}),d("添加子菜单成功","success"),h()}catch(i){d("添加子菜单失败: "+(((C=(_=i.response)==null?void 0:_.data)==null?void 0:C.error)||i.message),"error")}})}function M(s){return U(this,null,function*(){var t,l;try{yield ke(s.id,{name:s.name,order:s.order}),h()}catch(x){d("更新子菜单失败: "+(((l=(t=x.response)==null?void 0:t.data)==null?void 0:l.error)||x.message),"error")}})}function c(s){return U(this,null,function*(){var t,l;if(confirm("确定要删除这个子菜单吗？删除后将同时删除其下的所有卡片。"))try{yield be(s),d("删除成功","success"),h()}catch(x){d("删除子菜单失败: "+(((l=(t=x.response)==null?void 0:t.data)==null?void 0:l.error)||x.message),"error")}})}function a(s){const t=u.value.find(l=>l.id===s);t&&(t.showSubMenu=!t.showSubMenu)}return(s,t)=>(p(),w("div",Ee,[K(E,{message:g.value.message,type:g.value.type,show:g.value.show,"onUpdate:show":t[0]||(t[0]=l=>g.value.show=l)},null,8,["message","type","show"]),e("div",Ge,[t[3]||(t[3]=e("div",{class:"header-content"},[e("h2",{class:"page-title"},"管理主菜单和子菜单")],-1)),e("div",Je,[b(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>r.value=l),placeholder:"请输入主菜单名称",class:"input"},null,512),[[V,r.value]]),e("button",{class:"btn btn-primary",onClick:y},t[2]||(t[2]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),N(" 添加主菜单 ")]))])]),e("div",Qe,[e("div",Re,[(p(!0),w(F,null,P(u.value,l=>{var x;return p(),w("div",{key:l.id,class:"menu-item"},[e("div",We,[e("div",Xe,[t[5]||(t[5]=e("div",{class:"menu-icon"},[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 3h18v18H3zM9 9h6v6H9z"})])],-1)),b(e("input",{"onUpdate:modelValue":_=>l.name=_,onBlur:_=>f(l),class:"menu-name-input"},null,40,Ye),[[V,l.name]]),e("div",Ze,[t[4]||(t[4]=e("span",{class:"order-label"},"排序",-1)),b(e("input",{"onUpdate:modelValue":_=>l.order=_,type:"number",onBlur:_=>f(l),class:"order-input"},null,40,et),[[V,l.order,void 0,{number:!0}]])])]),e("div",tt,[e("button",{class:"btn btn-icon expand-btn",onClick:_=>a(l.id),title:l.showSubMenu?"收起子菜单":"展开子菜单"},t[6]||(t[6]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"m6 9 6 6 6-6"})],-1)]),8,st),e("button",{class:"btn btn-danger btn-icon",onClick:_=>v(l.id),title:"删除主菜单"},t[7]||(t[7]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)]),8,lt)])]),e("div",{class:L(["sub-menu-section",{expanded:l.showSubMenu}])},[e("div",nt,[e("div",ot,[t[8]||(t[8]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 11H1l8-8 8 8h-8v8z"})],-1)),N(" 子菜单 ("+T(((x=l.subMenus)==null?void 0:x.length)||0)+") ",1)]),e("button",{class:"btn btn-sm btn-outline",onClick:_=>$(l.id)},t[9]||(t[9]=[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),N(" 添加子菜单 ")]),8,at)]),l.subMenus&&l.subMenus.length>0?(p(),w("div",ut,[(p(!0),w(F,null,P(l.subMenus,_=>(p(),w("div",{key:_.id,class:"sub-menu-item"},[e("div",rt,[t[10]||(t[10]=e("div",{class:"sub-menu-icon"},[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M4 6h16M4 12h16M4 18h16"})])],-1)),b(e("input",{"onUpdate:modelValue":C=>_.name=C,onBlur:C=>M(_),class:"sub-menu-name-input"},null,40,it),[[V,_.name]]),e("div",dt,[b(e("input",{"onUpdate:modelValue":C=>_.order=C,type:"number",onBlur:C=>M(_),class:"order-input"},null,40,ct),[[V,_.order,void 0,{number:!0}]])])]),e("div",vt,[e("button",{class:"btn btn-danger btn-icon btn-sm",onClick:C=>c(_.id),title:"删除子菜单"},t[11]||(t[11]=[e("svg",{width:"14",height:"14",viewBox:"0 0 22 22",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)]),8,pt)])]))),128))])):(p(),w("div",ht,[t[12]||(t[12]=e("p",null,"暂无子菜单",-1)),e("button",{class:"btn btn-sm btn-outline",onClick:_=>$(l.id)},"添加第一个子菜单",8,mt)]))],2)])}),128))])])]))}},wt=z(gt,[["__scopeId","data-v-25d6a78c"]]),ft={class:"card-manage"},kt={class:"card-header"},bt={class:"card-add"},yt=["value"],$t=["value"],_t={key:0,class:"batch-actions"},Mt={class:"selected-count"},Ct={class:"batch-move"},Vt=["value"],Ut=["value"],Bt=["disabled"],xt={class:"card-card"},St={class:"card-table"},It={class:"checkbox-col"},Tt=["checked"],At={class:"checkbox-col"},Lt=["checked","onChange"],Ft=["onUpdate:modelValue","onBlur"],Pt=["onUpdate:modelValue","onBlur"],zt=["onUpdate:modelValue","onBlur"],Ht=["onUpdate:modelValue","onBlur"],Nt=["onUpdate:modelValue","onBlur"],jt=["onClick"],Dt={__name:"CardManage",setup(B){const u=m([]),r=m([]),g=m(),d=m(""),h=m(""),y=m(""),f=m(""),v=m([]),$=m(""),M=m(""),c=m({show:!1,message:"",type:"info"});function a(k,o="info"){c.value={show:!0,message:k,type:o}}const s=q(()=>{if(!g.value)return[];const k=u.value.find(o=>o.id===g.value);return(k==null?void 0:k.subMenus)||[]}),t=q(()=>{if(!$.value)return[];const k=u.value.find(o=>o.id===$.value);return(k==null?void 0:k.subMenus)||[]}),l=q(()=>r.value.length>0&&v.value.length===r.value.length);j(()=>U(null,null,function*(){const k=yield ee();u.value=k.data,u.value.length&&(g.value=u.value[0].id,d.value="")})),G(g,()=>{d.value="",v.value=[],C()}),G(d,()=>{v.value=[],C()});function x(){d.value=""}function _(){C()}function C(){return U(this,null,function*(){if(!g.value)return;const k=yield Ve(g.value,d.value||null);r.value=k.data})}function i(k){const o=v.value.indexOf(k);o>-1?v.value.splice(o,1):v.value.push(k)}function I(k){k.target.checked?v.value=r.value.map(o=>o.id):v.value=[]}function te(){v.value=[]}function se(){return U(this,null,function*(){var k,o;if(confirm(`确定要删除选中的 ${v.value.length} 个卡片吗？`))try{yield _e(v.value),a(`成功删除 ${v.value.length} 个卡片`,"success"),v.value=[],C()}catch(n){a("批量删除失败: "+(((o=(k=n.response)==null?void 0:k.data)==null?void 0:o.error)||n.message),"error")}})}function le(){return U(this,null,function*(){var k,o;if(!$.value){a("请选择目标菜单","warning");return}try{yield $e(v.value,$.value,M.value||null),a(`成功移动 ${v.value.length} 个卡片`,"success"),v.value=[],$.value="",M.value="",C()}catch(n){a("批量移动失败: "+(((o=(k=n.response)==null?void 0:k.data)==null?void 0:o.error)||n.message),"error")}})}function ne(){return U(this,null,function*(){var k,o;if(!h.value||!y.value){a("请填写卡片标题和链接","warning");return}try{yield ye({menu_id:g.value,sub_menu_id:d.value||null,title:h.value,url:y.value,logo_url:f.value}),h.value="",y.value="",f.value="",a("添加卡片成功","success"),C()}catch(n){a("添加卡片失败: "+(((o=(k=n.response)==null?void 0:k.data)==null?void 0:o.error)||n.message),"error")}})}function D(k){return U(this,null,function*(){var o,n;try{yield Me(k.id,{menu_id:k.menu_id||g.value,sub_menu_id:k.sub_menu_id,title:k.title,url:k.url,logo_url:k.logo_url,desc:k.desc,order:k.order}),C()}catch(S){a("更新卡片失败: "+(((n=(o=S.response)==null?void 0:o.data)==null?void 0:n.error)||S.message),"error")}})}function oe(k){return U(this,null,function*(){var o,n;if(confirm("确定要删除这个卡片吗？"))try{yield Ce(k),a("删除成功","success"),C()}catch(S){a("删除卡片失败: "+(((n=(o=S.response)==null?void 0:o.data)==null?void 0:n.error)||S.message),"error")}})}return(k,o)=>(p(),w("div",ft,[K(E,{message:c.value.message,type:c.value.type,show:c.value.show,"onUpdate:show":o[0]||(o[0]=n=>c.value.show=n)},null,8,["message","type","show"]),e("div",kt,[o[10]||(o[10]=e("div",{class:"header-content"},[e("h2",{class:"page-title"},"管理网站导航卡片，支持主菜单和子菜单分类")],-1)),e("div",bt,[b(e("select",{"onUpdate:modelValue":o[1]||(o[1]=n=>g.value=n),class:"input narrow",onChange:x},[(p(!0),w(F,null,P(u.value,n=>(p(),w("option",{value:n.id,key:n.id},T(n.name),9,yt))),128))],544),[[O,g.value]]),b(e("select",{"onUpdate:modelValue":o[2]||(o[2]=n=>d.value=n),class:"input narrow",onChange:_},[o[8]||(o[8]=e("option",{value:""},"主菜单",-1)),(p(!0),w(F,null,P(s.value,n=>(p(),w("option",{value:n.id,key:n.id},T(n.name),9,$t))),128))],544),[[O,d.value]]),b(e("input",{"onUpdate:modelValue":o[3]||(o[3]=n=>h.value=n),placeholder:"卡片标题",class:"input narrow"},null,512),[[V,h.value]]),b(e("input",{"onUpdate:modelValue":o[4]||(o[4]=n=>y.value=n),placeholder:"卡片链接",class:"input wide"},null,512),[[V,y.value]]),b(e("input",{"onUpdate:modelValue":o[5]||(o[5]=n=>f.value=n),placeholder:"logo链接(可选)",class:"input wide"},null,512),[[V,f.value]]),e("button",{class:"btn",onClick:ne},o[9]||(o[9]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),N(" 添加卡片 ")]))])]),v.value.length>0?(p(),w("div",_t,[e("span",Mt,"已选择 "+T(v.value.length)+" 项",1),e("div",Ct,[b(e("select",{"onUpdate:modelValue":o[6]||(o[6]=n=>$.value=n),class:"input narrow"},[o[11]||(o[11]=e("option",{value:""},"选择目标菜单",-1)),(p(!0),w(F,null,P(u.value,n=>(p(),w("option",{value:n.id,key:n.id},T(n.name),9,Vt))),128))],512),[[O,$.value]]),b(e("select",{"onUpdate:modelValue":o[7]||(o[7]=n=>M.value=n),class:"input narrow"},[o[12]||(o[12]=e("option",{value:""},"主菜单",-1)),(p(!0),w(F,null,P(t.value,n=>(p(),w("option",{value:n.id,key:n.id},T(n.name),9,Ut))),128))],512),[[O,M.value]]),e("button",{class:"btn btn-move",onClick:le,disabled:!$.value},"批量移动",8,Bt)]),e("button",{class:"btn btn-danger",onClick:se},"批量删除"),e("button",{class:"btn btn-cancel",onClick:te},"取消选择")])):A("",!0),e("div",xt,[e("table",St,[e("thead",null,[e("tr",null,[e("th",It,[e("input",{type:"checkbox",onChange:I,checked:l.value},null,40,Tt)]),o[13]||(o[13]=e("th",null,"标题",-1)),o[14]||(o[14]=e("th",null,"网址",-1)),o[15]||(o[15]=e("th",null,"Logo链接",-1)),o[16]||(o[16]=e("th",null,"描述",-1)),o[17]||(o[17]=e("th",null,"排序",-1)),o[18]||(o[18]=e("th",null,"操作",-1))])]),e("tbody",null,[(p(!0),w(F,null,P(r.value,n=>(p(),w("tr",{key:n.id,class:L({selected:v.value.includes(n.id)})},[e("td",At,[e("input",{type:"checkbox",checked:v.value.includes(n.id),onChange:S=>i(n.id)},null,40,Lt)]),e("td",null,[b(e("input",{"onUpdate:modelValue":S=>n.title=S,onBlur:S=>D(n),class:"table-input"},null,40,Ft),[[V,n.title]])]),e("td",null,[b(e("input",{"onUpdate:modelValue":S=>n.url=S,onBlur:S=>D(n),class:"table-input"},null,40,Pt),[[V,n.url]])]),e("td",null,[b(e("input",{"onUpdate:modelValue":S=>n.logo_url=S,onBlur:S=>D(n),class:"table-input",placeholder:"logo链接(可选)"},null,40,zt),[[V,n.logo_url]])]),e("td",null,[b(e("input",{"onUpdate:modelValue":S=>n.desc=S,onBlur:S=>D(n),class:"table-input",placeholder:"描述（可选）"},null,40,Ht),[[V,n.desc]])]),e("td",null,[b(e("input",{"onUpdate:modelValue":S=>n.order=S,type:"number",onBlur:S=>D(n),class:"table-input order-input"},null,40,Nt),[[V,n.order,void 0,{number:!0}]])]),e("td",null,[e("button",{class:"btn btn-danger btn-icon",onClick:S=>oe(n.id),title:"删除"},o[19]||(o[19]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)]),8,jt)])],2))),128))])])])]))}},Ot=z(Dt,[["__scopeId","data-v-8a793e82"]]),Kt={class:"ad-manage"},qt={class:"ad-header"},Et={class:"ad-section"},Gt={class:"ad-card"},Jt={class:"ad-table"},Qt=["onUpdate:modelValue","onBlur"],Rt=["onUpdate:modelValue","onBlur"],Wt=["onClick"],Xt={class:"ad-section"},Yt={class:"ad-card"},Zt={class:"ad-table"},es=["onUpdate:modelValue","onBlur"],ts=["onUpdate:modelValue","onBlur"],ss=["onClick"],ls={__name:"AdManage",setup(B){const u=m([]),r=m([]),g=m(""),d=m(""),h=m("left"),y=m({show:!1,message:"",type:"info"});function f(a,s="info"){y.value={show:!0,message:a,type:s}}j(v);function v(){return U(this,null,function*(){const a=yield Ue();u.value=a.data.filter(s=>s.position==="left"),r.value=a.data.filter(s=>s.position==="right")})}function $(){return U(this,null,function*(){var a,s;if(!g.value||!d.value){f("请填写广告图片链接和跳转链接","warning");return}try{yield Be({position:h.value,img:g.value,url:d.value}),g.value="",d.value="",h.value="left",f("添加广告成功","success"),v()}catch(t){f("添加广告失败: "+(((s=(a=t.response)==null?void 0:a.data)==null?void 0:s.error)||t.message),"error")}})}function M(a){return U(this,null,function*(){var s,t;try{yield xe(a.id,{position:a.position,img:a.img,url:a.url}),v()}catch(l){f("更新广告失败: "+(((t=(s=l.response)==null?void 0:s.data)==null?void 0:t.error)||l.message),"error")}})}function c(a){return U(this,null,function*(){var s,t;if(confirm("确定要删除这个广告吗？"))try{yield Se(a),f("删除成功","success"),v()}catch(l){f("删除广告失败: "+(((t=(s=l.response)==null?void 0:s.data)==null?void 0:t.error)||l.message),"error")}})}return(a,s)=>(p(),w("div",Kt,[K(E,{message:y.value.message,type:y.value.type,show:y.value.show,"onUpdate:show":s[0]||(s[0]=t=>y.value.show=t)},null,8,["message","type","show"]),e("div",qt,[e("form",{class:"ad-add-row",onSubmit:Z($,["prevent"])},[b(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>g.value=t),placeholder:"广告图片链接",class:"input"},null,512),[[V,g.value]]),b(e("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>d.value=t),placeholder:"广告跳转链接",class:"input"},null,512),[[V,d.value]]),b(e("select",{"onUpdate:modelValue":s[3]||(s[3]=t=>h.value=t),class:"input select-input"},s[4]||(s[4]=[e("option",{value:"left"},"左侧广告",-1),e("option",{value:"right"},"右侧广告",-1)]),512),[[O,h.value]]),s[5]||(s[5]=e("button",{class:"btn",type:"submit"},"添加广告",-1))],32)]),e("div",Et,[s[7]||(s[7]=e("h3",{class:"section-title"},"左侧广告列表",-1)),e("div",Gt,[e("table",Jt,[s[6]||(s[6]=e("thead",null,[e("tr",null,[e("th",null,"图片"),e("th",null,"跳转链接"),e("th",null,"操作")])],-1)),e("tbody",null,[(p(!0),w(F,null,P(u.value,t=>(p(),w("tr",{key:t.id},[e("td",null,[b(e("input",{"onUpdate:modelValue":l=>t.img=l,onBlur:l=>M(t),class:"input"},null,40,Qt),[[V,t.img]])]),e("td",null,[b(e("input",{"onUpdate:modelValue":l=>t.url=l,onBlur:l=>M(t),class:"input"},null,40,Rt),[[V,t.url]])]),e("td",null,[e("button",{class:"btn btn-danger",onClick:l=>c(t.id)},"删除广告",8,Wt)])]))),128))])])])]),e("div",Xt,[s[9]||(s[9]=e("h3",{class:"section-title"},"右侧广告列表",-1)),e("div",Yt,[e("table",Zt,[s[8]||(s[8]=e("thead",null,[e("tr",null,[e("th",null,"图片"),e("th",null,"跳转链接"),e("th",null,"操作")])],-1)),e("tbody",null,[(p(!0),w(F,null,P(r.value,t=>(p(),w("tr",{key:t.id},[e("td",null,[b(e("input",{"onUpdate:modelValue":l=>t.img=l,onBlur:l=>M(t),class:"input"},null,40,es),[[V,t.img]])]),e("td",null,[b(e("input",{"onUpdate:modelValue":l=>t.url=l,onBlur:l=>M(t),class:"input"},null,40,ts),[[V,t.url]])]),e("td",null,[e("button",{class:"btn btn-danger",onClick:l=>c(t.id)},"删除广告",8,ss)])]))),128))])])])])]))}},ns=z(ls,[["__scopeId","data-v-4e6a8cde"]]),os={class:"friend-manage"},as={class:"friend-add"},us={class:"friend-card"},rs={class:"friend-table"},is=["onUpdate:modelValue","onBlur"],ds=["onUpdate:modelValue","onBlur"],cs=["onUpdate:modelValue","onBlur"],vs=["onClick"],ps={__name:"FriendLinkManage",setup(B){const u=m([]),r=m(""),g=m(""),d=m(""),h=m({show:!1,message:"",type:"info"});function y(c,a="info"){h.value={show:!0,message:c,type:a}}j(f);function f(){return U(this,null,function*(){const c=yield Ie();u.value=c.data})}function v(){return U(this,null,function*(){var c,a;if(!r.value||!g.value){y("请填写网站名和链接","warning");return}try{yield Te({title:r.value,url:g.value,logo:d.value}),r.value="",g.value="",d.value="",y("添加友链成功","success"),f()}catch(s){y("添加友链失败: "+(((a=(c=s.response)==null?void 0:c.data)==null?void 0:a.error)||s.message),"error")}})}function $(c){return U(this,null,function*(){var a,s;try{yield Ae(c.id,{title:c.title,url:c.url,logo:c.logo}),f()}catch(t){y("更新友链失败: "+(((s=(a=t.response)==null?void 0:a.data)==null?void 0:s.error)||t.message),"error")}})}function M(c){return U(this,null,function*(){var a,s;if(confirm("确定要删除这个友链吗？"))try{yield Le(c),y("删除成功","success"),f()}catch(t){y("删除友链失败: "+(((s=(a=t.response)==null?void 0:a.data)==null?void 0:s.error)||t.message),"error")}})}return(c,a)=>(p(),w("div",os,[K(E,{message:h.value.message,type:h.value.type,show:h.value.show,"onUpdate:show":a[0]||(a[0]=s=>h.value.show=s)},null,8,["message","type","show"]),a[5]||(a[5]=e("div",{class:"friend-header"},null,-1)),e("div",as,[b(e("input",{"onUpdate:modelValue":a[1]||(a[1]=s=>r.value=s),placeholder:"网站名",class:"input"},null,512),[[V,r.value]]),b(e("input",{"onUpdate:modelValue":a[2]||(a[2]=s=>g.value=s),placeholder:"网站链接",class:"input"},null,512),[[V,g.value]]),b(e("input",{"onUpdate:modelValue":a[3]||(a[3]=s=>d.value=s),placeholder:"logo链接(可选)",class:"input"},null,512),[[V,d.value]]),e("button",{class:"btn",onClick:v},"添加友链")]),e("div",us,[e("table",rs,[a[4]||(a[4]=e("thead",null,[e("tr",null,[e("th",null,"网站名"),e("th",null,"链接"),e("th",null,"Logo"),e("th",null,"操作")])],-1)),e("tbody",null,[(p(!0),w(F,null,P(u.value,s=>(p(),w("tr",{key:s.id},[e("td",null,[b(e("input",{"onUpdate:modelValue":t=>s.title=t,onBlur:t=>$(s),class:"input"},null,40,is),[[V,s.title]])]),e("td",null,[b(e("input",{"onUpdate:modelValue":t=>s.url=t,onBlur:t=>$(s),class:"input"},null,40,ds),[[V,s.url]])]),e("td",null,[b(e("input",{"onUpdate:modelValue":t=>s.logo=t,onBlur:t=>$(s),class:"input",placeholder:"logo链接(可选)"},null,40,cs),[[V,s.logo]])]),e("td",null,[e("button",{class:"btn btn-danger",onClick:t=>M(s.id)},"删除",8,vs)])]))),128))])])])]))}},hs=z(ps,[["__scopeId","data-v-9bdae6d7"]]),ms={class:"user-manage"},gs={class:"user-card"},ws={class:"password-section"},fs={class:"password-form"},ks={class:"form-group"},bs={class:"form-group"},ys={class:"form-group"},$s={class:"form-actions"},_s=["disabled"],Ms={__name:"UserManage",setup(B){const u=m(""),r=m(""),g=m(""),d=m(!1),h=m(""),y=m("success"),f=m({});j(()=>U(null,null,function*(){try{const M=yield Fe();f.value=M.data}catch(M){console.error("获取用户信息失败:",M)}}));function v(){return U(this,null,function*(){var M,c;if(!u.value||!r.value||!g.value){$("请填写所有密码字段","error");return}if(r.value!==g.value){$("两次输入的新密码不一致","error");return}if(r.value.length<6){$("新密码长度至少6位","error");return}d.value=!0,h.value="";try{yield Pe(u.value,r.value),$("密码修改成功","success"),u.value="",r.value="",g.value=""}catch(a){$(((c=(M=a.response)==null?void 0:M.data)==null?void 0:c.message)||"密码修改失败","error")}finally{d.value=!1}})}function $(M,c){h.value=M,y.value=c,M==="密码修改成功"&&c==="success"?setTimeout(()=>{h.value="2秒后自动退出登录,请使用新密码重新登录...",setTimeout(()=>{localStorage.removeItem("token"),window.location.reload()},2e3)},500):setTimeout(()=>{h.value=""},3e3)}return(M,c)=>(p(),w("div",ms,[c[7]||(c[7]=e("div",{class:"user-header"},null,-1)),e("div",gs,[e("div",ws,[c[6]||(c[6]=e("h3",{class:"section-title"},"修改密码",-1)),e("div",fs,[e("div",ks,[c[3]||(c[3]=e("label",null,"当前密码：",-1)),b(e("input",{"onUpdate:modelValue":c[0]||(c[0]=a=>u.value=a),type:"password",placeholder:"请输入当前密码",class:"input"},null,512),[[V,u.value]])]),e("div",bs,[c[4]||(c[4]=e("label",null,"新密码：",-1)),b(e("input",{"onUpdate:modelValue":c[1]||(c[1]=a=>r.value=a),type:"password",placeholder:"请输入新密码",class:"input"},null,512),[[V,r.value]])]),e("div",ys,[c[5]||(c[5]=e("label",null,"确认新密码：",-1)),b(e("input",{"onUpdate:modelValue":c[2]||(c[2]=a=>g.value=a),type:"password",placeholder:"请再次输入新密码",class:"input"},null,512),[[V,g.value]])]),e("div",$s,[e("button",{onClick:v,class:"btn",disabled:d.value},T(d.value?"修改中...":"修改密码"),9,_s)]),h.value?(p(),w("p",{key:0,class:L(["message",y.value])},T(h.value),3)):A("",!0)])])])]))}},Cs=z(Ms,[["__scopeId","data-v-85ce40f4"]]),Vs={key:0,class:"login-container"},Us={class:"login-card"},Bs={class:"login-form"},xs={class:"password-input-wrapper"},Ss=["type"],Is={key:0,width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},Ts={key:1,width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},As={class:"login-buttons"},Ls=["disabled"],Fs={key:0,class:"login-error"},Ps={key:1,class:"admin-layout"},zs={class:"menu-list"},Hs={class:"admin-main"},Ns={class:"admin-header"},js={class:"header-title"},Ds={class:"admin-content"},Os={key:0,class:"welcome-page"},Ks={class:"welcome-cards"},qs={class:"welcome-card"},Es={class:"welcome-value"},Gs={class:"welcome-card"},Js={class:"welcome-value"},Qs={__name:"Admin",setup(B){const u=m("welcome"),r=m(""),g=m(""),d=m(!1),h=m(""),y=m(""),f=m(!1),v=m(""),$=m(!1),M=m(!1),c=q(()=>{switch(u.value){case"menu":return"栏目管理";case"card":return"卡片管理";case"ad":return"广告管理";case"friend":return"友链管理";case"user":return"用户管理";default:return""}});j(()=>{const C=localStorage.getItem("token");d.value=!!C,d.value&&a()});function a(){return U(this,null,function*(){try{const C=yield fetch("/api/users/me",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(C.ok){const i=yield C.json();r.value=i.last_login_time||"",g.value=i.last_login_ip||""}}catch(C){console.error("获取用户信息失败:",C)}})}function s(){return U(this,null,function*(){var C,i;if(!h.value||!y.value){v.value="请输入用户名和密码";return}f.value=!0,v.value="";try{const I=yield ze(h.value,y.value);I.data.token&&(localStorage.setItem("token",I.data.token),d.value=!0,r.value=I.data.lastLoginTime||"",g.value=I.data.lastLoginIp||"")}catch(I){v.value=((i=(C=I.response)==null?void 0:C.data)==null?void 0:i.message)||"登录失败，请检查用户名和密码"}finally{f.value=!1}})}function t(){localStorage.removeItem("token"),d.value=!1,h.value="",y.value="",v.value=""}function l(){window.open("/","_blank")}function x(){M.value=!M.value}function _(){M.value=!1}return(C,i)=>d.value?(p(),w("div",Ps,[e("aside",{class:L(["admin-sider",{open:M.value}]),onClick:Z(_,["self"])},[e("div",{class:"logo clickable",onClick:i[3]||(i[3]=I=>{u.value="welcome",_()})},"Admin"),e("ul",zs,[e("li",{class:L({active:u.value==="menu"}),onClick:i[4]||(i[4]=I=>{u.value="menu",_()})},"栏目管理",2),e("li",{class:L({active:u.value==="card"}),onClick:i[5]||(i[5]=I=>{u.value="card",_()})},"卡片管理",2),e("li",{class:L({active:u.value==="ad"}),onClick:i[6]||(i[6]=I=>{u.value="ad",_()})},"广告管理",2),e("li",{class:L({active:u.value==="friend"}),onClick:i[7]||(i[7]=I=>{u.value="friend",_()})},"友链管理",2),e("li",{class:L({active:u.value==="user"}),onClick:i[8]||(i[8]=I=>{u.value="user",_()})},"用户管理",2)])],2),e("main",Hs,[e("div",Ns,[e("button",{class:"menu-toggle",onClick:x}," ☰ "),e("div",js,T(c.value),1),e("div",{class:"header-actions"},[e("span",{class:"home-icon",onClick:l,title:"进入主页"},i[13]||(i[13]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},[e("path",{d:"M3 10.5L12 4l9 6.5V20a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1v-4h-4v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V10.5z",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])),e("button",{class:"btn logout-btn",onClick:t},"退出登录")])]),e("div",Ds,[u.value==="welcome"?(p(),w("div",Os,[i[16]||(i[16]=e("h2",{class:"welcome-title"},"欢迎您进入 Nav-Item 后台管理系统",-1)),e("div",Ks,[e("div",qs,[i[14]||(i[14]=Y('<div class="welcome-icon time-icon" data-v-54d5c650><svg width="32" height="32" viewBox="0 0 24 24" fill="none" data-v-54d5c650><circle cx="12" cy="12" r="10" stroke="#1abc9c" stroke-width="2" data-v-54d5c650></circle><path d="M12 6v6l4 2" stroke="#1abc9c" stroke-width="2" stroke-linecap="round" data-v-54d5c650></path></svg></div><div class="welcome-label" data-v-54d5c650>上次登录时间</div>',2)),e("div",Es,T(r.value||"--"),1)]),e("div",Gs,[i[15]||(i[15]=Y('<div class="welcome-icon ip-icon" data-v-54d5c650><svg width="32" height="32" viewBox="0 0 24 24" fill="none" data-v-54d5c650><circle cx="12" cy="12" r="10" stroke="#1abc9c" stroke-width="2" data-v-54d5c650></circle><path d="M12 8a4 4 0 1 1 0 8 4 4 0 0 1 0-8z" stroke="#1abc9c" stroke-width="2" data-v-54d5c650></path><circle cx="12" cy="12" r="2" fill="#1abc9c" data-v-54d5c650></circle></svg></div><div class="welcome-label" data-v-54d5c650>上次登录IP</div>',2)),e("div",Js,T(g.value||"--"),1)])])])):A("",!0),u.value==="menu"?(p(),H(wt,{key:1})):A("",!0),u.value==="card"?(p(),H(Ot,{key:2})):A("",!0),u.value==="ad"?(p(),H(ns,{key:3})):A("",!0),u.value==="friend"?(p(),H(hs,{key:4})):A("",!0),u.value==="user"?(p(),H(Cs,{key:5})):A("",!0)]),i[17]||(i[17]=e("footer",{class:"admin-footer"},[e("p",{class:"admin-copyright"},[N("Copyright © 2025 Nav-Item | "),e("a",{href:"https://github.com/eooce/Nav-Item",target:"_blank",class:"footer-link"},"Powered by eooce")])],-1))])])):(p(),w("div",Vs,[e("div",Us,[i[12]||(i[12]=e("h2",{class:"login-title"},"后台管理登录",-1)),e("div",Bs,[b(e("input",{"onUpdate:modelValue":i[0]||(i[0]=I=>h.value=I),type:"text",placeholder:"用户名",class:"login-input",onKeyup:X(s,["enter"])},null,544),[[V,h.value]]),e("div",xs,[b(e("input",{"onUpdate:modelValue":i[1]||(i[1]=I=>y.value=I),type:$.value?"text":"password",placeholder:"密码",class:"login-input password-input",onKeyup:X(s,["enter"])},null,40,Ss),[[he,y.value]]),e("span",{class:"toggle-password",onClick:i[2]||(i[2]=I=>$.value=!$.value)},[$.value?(p(),w("svg",Is,i[9]||(i[9]=[e("path",{d:"M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12z"},null,-1),e("circle",{cx:"12",cy:"12",r:"3"},null,-1)]))):(p(),w("svg",Ts,i[10]||(i[10]=[e("path",{d:"M17.94 17.94A10.94 10.94 0 0 1 12 19c-7 0-11-7-11-7a21.77 21.77 0 0 1 5.06-6.06"},null,-1),e("path",{d:"M1 1l22 22"},null,-1),e("path",{d:"M9.53 9.53A3 3 0 0 0 12 15a3 3 0 0 0 2.47-5.47"},null,-1)])))])]),e("div",As,[e("button",{onClick:l,class:"back-btn"},i[11]||(i[11]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1),N(" 返回首页 ")])),e("button",{onClick:s,class:"login-btn",disabled:f.value},T(f.value?"登录中...":"登录"),9,Ls)]),v.value?(p(),w("p",Fs,T(v.value),1)):A("",!0)])])]))}},Ys=z(Qs,[["__scopeId","data-v-54d5c650"]]);export{Ys as default};
